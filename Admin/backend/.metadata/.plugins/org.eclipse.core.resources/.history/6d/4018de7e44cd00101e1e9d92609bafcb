package com.user.controller;

import user.com.dto.*;
import user.com.service.CatalogService;

import lombok.RequiredArgsConstructor;
import org.springframework.web.bind.annotation.*;

import java.time.LocalDate;
import java.util.List;

@RestController
@RequestMapping("/api/catalog")
@CrossOrigin("*")
@RequiredArgsConstructor
public class CatalogController {

    private final CatalogService service;

    @GetMapping("/categories")
    public List<CategoryDTO> categories() {
        return service.getCategories();
    }

    @GetMapping("/services/{categoryId}")
    public List<SubServiceDTO> services(@PathVariable int categoryId) {
        return service.getServicesByCategory(categoryId);
    }

    @GetMapping("/venues/{serviceId}")
    public List<VenueDTO> venues(@PathVariable int serviceId) {
        return service.getVenuesByService(serviceId);
    }

    @GetMapping("/spots/{venueId}")
    public List<SpotDTO> spots(@PathVariable int venueId) {
        return service.getSpotsByVenue(venueId);
    }

    @GetMapping("/slots/{spotId}")
    public List<SlotDTO> slots(@PathVariable int spotId, @RequestParam String date) {
        return service.getSlotsBySpot(spotId, LocalDate.parse(date));
    }
}
